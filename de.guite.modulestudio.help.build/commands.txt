# Commands for generating emf plugins from corresponding models and building a p2 site with these bundles

# materialise stuff by cquery/rmap
resolve --properties "refProduct/bundles/de.guite.modulestudio.build/buckminster.properties" "scm/de.guite.modulestudio.help.build/most.cquery"

# gather metrics on source code level
perform --properties "refProduct/bundles/de.guite.modulestudio.build/buckminster.properties" "de.guite.modulestudio.help.build#metrics.prebuild"

# build workspace
build
#build --thorough

# run tests and code coverage (buckminster emma --help)
emma --properties "refProduct/bundles/de.guite.modulestudio.build/buckminster.properties" --launch "de.guite.modulestudio.help.tests/AllTests.launch" --terseXML --flatXML --output "${WORKSPACE}output/test_results/junit/alltests.xml" --xml "${WORKSPACE}output/test_results/coverage/alltests.xml" --stderr --stdout
#emma --properties "refProduct/bundles/de.guite.modulestudio.build/buckminster.properties" --launch "de.guite.modulestudio.help.tests/OtherTests.launch" --terseXML --flatXML --output "${WORKSPACE}output/test_results/junit/othertests.xml" --xml "${WORKSPACE}output/test_results/coverage/othertests.xml" --stderr --stdout

# build feature p2 repository
perform --properties "refProduct/bundles/de.guite.modulestudio.build/buckminster.properties" "de.guite.modulestudio.help.build#site.p2"

# gather metrics on byte code level
perform --properties "refProduct/bundles/de.guite.modulestudio.build/buckminster.properties" "de.guite.modulestudio.help.build#metrics.postbuild"

# move repository to /site.p2.artifact/
perform "de.guite.modulestudio.help.build#finish.repository"

# generate API documentation
perform --properties "refProduct/bundles/de.guite.modulestudio.build/buckminster.properties" "de.guite.modulestudio.help.build#create.documentation"
